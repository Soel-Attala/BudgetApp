<Window x:Class="Presupuestos.WPF.Views.MaterialPickerDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Seleccionar materiales" Height="560" Width="860"
        WindowStartupLocation="CenterOwner" ResizeMode="CanResizeWithGrip">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal">
            <TextBox Width="280" x:Name="SearchBox" TextChanged="SearchBox_TextChanged" ToolTip="Buscar por nombre" Margin="0,0,8,0"/>
            <Button Content="Limpiar" Click="Clear_Click" Margin="0,0,8,0"/>
            <CheckBox x:Name="OnlySelectedCheck" Content="Ver solo seleccionados" Checked="OnlySelectedCheck_Changed" Unchecked="OnlySelectedCheck_Changed" Margin="0,0,8,0"/>
            <Button Content="Seleccionar todo" Click="SelectAll_Click" Margin="0,0,8,0"/>
            <Button Content="Quitar selección" Click="ClearSelection_Click"/>
        </StackPanel>

        <DataGrid Grid.Row="1" x:Name="Grid" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="False" Margin="0,8,0,8">
            <DataGrid.Columns>
                <DataGridCheckBoxColumn Header="" Binding="{Binding IsSelected}" Width="40"/>
                <DataGridTextColumn Header="Nombre" Binding="{Binding Material.Name}" Width="2*"/>
                <DataGridTextColumn Header="USD" Binding="{Binding Material.PriceUSD, StringFormat={}{0:N2}}" Width="120" IsReadOnly="True"/>
                <DataGridTemplateColumn Header="Cantidad" Width="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Quantity, StringFormat={}{0:N2}}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <DataGridTemplateColumn.CellEditingTemplate>
                        <DataTemplate>
                            <TextBox Text="{Binding Quantity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellEditingTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Cancelar" Click="Cancel_Click" Margin="0,0,8,0"/>
            <Button Content="Agregar seleccionados" Click="Accept_Click"/>
        </StackPanel>
    </Grid>
</Window>
