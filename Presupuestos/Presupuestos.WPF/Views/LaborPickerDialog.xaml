<Window x:Class="Presupuestos.WPF.Views.LaborPickerDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Seleccionar mano de obra" Height="600" Width="900"
        WindowStartupLocation="CenterOwner" ResizeMode="CanResizeWithGrip">
    <Grid Margin="16">
        <!-- RowDefinitions como BLOQUE -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- sin Spacing (usar Margin entre controles) -->
        <StackPanel Orientation="Horizontal">
            <ComboBox x:Name="CategoryCombo" Width="220" DisplayMemberPath="Name" SelectionChanged="FilterChanged" Margin="0,0,8,0"/>
            <TextBox  x:Name="SearchBox"   Width="280" TextChanged="FilterChanged" ToolTip="Buscar por nombre o unidad" Margin="0,0,8,0"/>
            <CheckBox x:Name="OnlySelectedCheck" Content="Ver solo seleccionados" Checked="FilterChanged" Unchecked="FilterChanged" Margin="0,0,8,0"/>
            <Button Content="Seleccionar todo" Click="SelectAll_Click" Margin="0,0,8,0"/>
            <Button Content="Quitar selección" Click="ClearSelection_Click" Margin="0,0,8,0"/>
            <Button Content="Limpiar filtros" Click="ClearFilters_Click"/>
        </StackPanel>

        <DataGrid Grid.Row="1" x:Name="Grid" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="False" Margin="0,8,0,8">
            <DataGrid.Columns>
                <DataGridCheckBoxColumn Header="" Binding="{Binding IsSelected}" Width="40"/>
                <DataGridTextColumn   Header="Nombre"     Binding="{Binding Item.Name}"          Width="*"/>
                <DataGridTextColumn   Header="Categoría"  Binding="{Binding Item.Category.Name}" Width="160"/>
                <DataGridTextColumn   Header="Unidad"     Binding="{Binding Item.Unit}"          Width="100"/>
                <DataGridTextColumn   Header="Unit ARS"   Binding="{Binding Item.PriceARS, StringFormat={}{0:N6}}" Width="120"/>
                <DataGridTemplateColumn Header="Cantidad" Width="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Quantity, StringFormat={}{0:N2}}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                    <DataGridTemplateColumn.CellEditingTemplate>
                        <DataTemplate>
                            <TextBox Text="{Binding Quantity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellEditingTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button Content="Cancelar" Click="Cancel_Click" Margin="0,0,8,0"/>
            <Button Content="Agregar seleccionados" Click="Accept_Click"/>
        </StackPanel>
    </Grid>
</Window>
